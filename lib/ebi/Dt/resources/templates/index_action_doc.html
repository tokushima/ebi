<rt:extends href="base.html" />

<rt:block name="content">

<p class="h3 {$t.cond_switch($action_info.opt('deprecated'),'deprecated;','')}">
	{$action_info.opt('name')}
</p>

<div class="alert alert-secondary" style="margin-top: 10px; margin-bottom: 50px; min-height: 50px;">
{$t.noop($f.md2html($action_info.document()))}
</div>

<div class="card mb-3">
	<div class="card-header text-white bg-info">
		Infomation
	</div>
	<div class="card-body">
		<table class="table table-sm style-table-borderless">
		<tr>
			<th>Version</th>
			<td>
				<rt:if param="{$action_info.version()}">
					<a href="{$t.package_method_url('index')}?version={$action_info.version()}">
						{$action_info.version()}
					</a>
				<rt:else />
					-
				</rt:if>
			</td>
		</tr>
		<tr>
			<th>URL</th>
			<td>
				{$action_info.opt('url')}
			</td>
		</tr>
		
		
		<rt:if param="{$action_info.opt('method')}">
		<tr>
			<th>Action</th>
			<td>
				<div class="{$t.cond_switch($action_info.opt('deprecated'),'deprecated','')}">
					<a href="{$t.package_method_url('class_doc',$action_info.opt('class'))}">
						{$action_info.opt('class')}
					</a>
					::
					<a href="{$t.package_method_url('class_method_doc',$action_info.opt('class'),$action_info.opt('method'))}">
						{$action_info.opt('method')}
					</a>
				</div>
			</td>
		</tr>
		</rt:if>
		
		
		<tr>
			<th>HTTP Method</th>
			<td>
				<rt:if param="{$action_info.opt('http_method')}">
					{$action_info.opt('http_method')}
				<rt:else/>
					GET / POST
				</rt:if>
			</td>
		</tr>
		
		<rt:if param="{$action_info.opt('user_model')}">
		<tr>
			<th>User model</th>
			<td>
				<rt:if param="{$action_info.opt('user_model')}">
					<a href="{$t.package_method_url('class_doc',$action_info.opt('user_model'))}">
						{$action_info.opt('user_model')}
					</a>
				<rt:else/>
					-
				</rt:if>
			</td>
		</tr>
		</rt:if>
		
		<rt:if param="{$action_info.opt('deprecated')}">
			<tr>
				<th class="text-danger">Deprecated</th>
				<td>
					<div class="text-danger">
						{$t.date_format('Y-m-d',$action_info.opt('deprecated'))}
					</div>
				</td>
			</tr>
		</rt:if>
		
		<tr class="text-secondary">
			<th>Raw</th>
			<td>
				<table rt:param="{$map}" rt:key="prop" rt:var="value" class="table">
				<tr>
					<th>{$prop}</th>
					<td>{$value}</td>
				</tr>
				</table>
			</td>
		</tr>
		
		</table>
	</div>
</div>



<rt:if param="{$action_info.params()}">

<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-secondary">Params</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.params()}" rt:var="param" class="table table-sm table-striped style-table-borderless">
		<tr>
			<td>
				{$param.name()}
			</td>
			<td>
				<rt:if param="{$action_info.is_type_class()}">
					<a href="{$t.package_method_url('class_doc',$action_info.plain_type())}">
						{$param.fm_type()}
					</a>
				<rt:else />
					{$param.fm_type()}
				</rt:if>
			</td>
			<td>
				{$t.html($param.summary())}
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>


<rt:if param="{$action_info.opt('requests')}">
<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-success">Request</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('requests')}" rt:var="param" class="table table-sm table-striped style-table-borderless">
		<tr class="{$t.cond_switch($param.opt('deprecated'),'deprecated','')}">
			<td>
				{$param.name()}
				
				<rt:if param="{$param.opt('require')}">
					<span style="color: #ffbbbb;">*</span>
				</rt:if>
			</td>
			<td>
				<rt:if param="{$param.is_type_class()}">
					<a href="{$t.package_method_url('class_doc',$param.plain_type())}">
						{$param.fm_type()}
					</a>
				<rt:else />
					{$param.fm_type()}
				</rt:if>
			</td>
			<td>
				{$t.html($param.summary())}
				
				<rt:if param="{$param.opt('deprecated')}">
					<div>
						<span class="badge badge-warning">
							Deprecated
							{$t.date_format('Y-m-d',$param.opt('deprecated'))}
						</span>
					</div>
				</rt:if>
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>



<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-warning">Send</div>
	<div class="card-body text-white bg-light">
		<script type="text/javascript">
			function submit_linkform(datafrm,method){
				linkform.action = datafrm.url.value;
				linkform.method = method;
				
				try{
					data = [];
					datafrm.query.value = datafrm.query.value.replace(/(^\s+)|(\s+$)/g,'');
					
					if(datafrm.query.value){
						data = $.parseJSON(datafrm.query.value);
					}				
					for(key in data){
						$('<input />')
						.attr('type','hidden')
						.attr('name',key)
						.attr('value',data[key])
						.appendTo('#linkform');
					}
					linkform.submit();
				}catch(e){
					alert('query invalid: ' + e);
				}
			}
		</script>
		
		<form name="linkdata">
			<input type="text" name="url" value="{$action_info.opt('url')}" class="form-control" />
			<textarea name="query" class="form-control" rows="5" style="margin-top: 10px;" placeholder='{"key1":"value","key2":"value"}'></textarea>
			
			<div>
				<button type="button" class="btn btn-sm btn-outline-primary" onclick="submit_linkform(linkdata,'post')" style="margin: 5px 5px 5px 0;">POST</button>
				<button type="button" class="btn btn-sm btn-outline-success" onclick="submit_linkform(linkdata,'get')" style="margin: 5px 5px 5px 0;">GET</button>
			</div>
		</form>
	</div>
</div>



<rt:if param="{$action_info.opt('contexts')}">
<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-success">Context</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('contexts')}" rt:var="param" class="table table-sm table-striped style-table-borderless">
		<tr class="{$t.cond_switch($param.opt('deprecated'),'deprecated','')}">
			<td>
				{$param.name()}
			</td>
			<td>
				<rt:if param="{$param.is_type_class()}">
					<a href="{$t.package_method_url('class_doc',$param.plain_type())}">
						{$param.fm_type()}
					</a>
				<rt:else />
					{$param.fm_type()}
				</rt:if>
			</td>
			<td>
				{$t.html($param.summary())}

				<rt:if param="{$param.opt('deprecated')}">
					<span class="badge badge-warning">
						Deprecated
						{$t.date_format('Y-m-d',$param.opt('deprecated'))}
					</span>
				</rt:if>
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>



<rt:if param="{$action_info.opt('throws')}">
<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-danger">Throws</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('throws')}" rt:var="param" class="table table-sm table-striped style-table-borderless">
		<tr>
			<td>
				<rt:if param="{$param.is_type_class()}">
					<a href="{$t.package_method_url('class_doc',$param.plain_type())}">
						{$param.fm_type()}
					</a>
				<rt:else />
					{$param.fm_type()}
				</rt:if>
			</td>
			<td>
				{$t.html($param.summary())}
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>



<rt:if param="{$action_info.opt('mail_list')}">
<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-info">Mail</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('mail_list')}" rt:var="info" class="table table-sm table-striped style-table-borderless">
		<tr>
			<td>
				<a href="{$t.package_method_url('mail_info')}?tcode={$info.opt('x_t_code')}">
					{$info.opt('x_t_code')}
				</a>
			</td>
			<td>
				{$info.name()}
			</td>
			<td>
				<a href="{$t.package_method_url('index')}?version={$info.version()}">
					{$info.version()}
				</a>
			</td>
			<td>
				{$t.html($info.document())}
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>



<rt:if param="{$action_info.opt('plugins')}">
<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-info">Plugins</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('plugins')}" rt:var="info" class="table table-sm table-striped style-table-borderless">
		<tr>
			<td>
				<a href="{$t.package_method_url('plugin_doc',$action_info.opt('class'),$info.name())}">
					{$info.name()}
				</a>
			</td>
			
			<td>
				{$t.html($info.summary(),200,1)}
			</td>
			<td>
				<rt:loop param="{$info.opt('added')}" var="class_name">
					<div>
						<a href="{$t.package_method_url('class_method_doc',$class_name,$info.name())}">
							{$class_name}
						</a>
					</div>
				</rt:loop>
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>


<rt:if param="{$action_info.opt('see_list')}">
<div class="card border-secondary mb-3">
	<div class="card-header text-white bg-info">See</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('see_list')}" rt:var="see" class="table table-sm table-striped style-table-borderless">
		<tr>
			<td>
				<rt:if param="{$t.eq($see['type'],'url')}">
					<a href="{$see['url']}">{$see['url']}</a>
				</rt:if>
				<rt:if param="{$t.eq($see['type'],'method')}">
					<a href="{$t.package_method_url('class_method_doc',$see['class'],$see['method'])}">{$see['class']}::{$see['method']}</a>
				</rt:if>
				<rt:if param="{$t.eq($see['type'],'class')}">
					<a href="{$t.package_method_url('class_doc',$see['class'])}">{$see['class']}</a>					
				</rt:if>
			</td>
		</tr>
		</table>

	</div>
</div>
</rt:if>


<rt:if param="{$action_info.opt('test_list')}">
<div class="card border-secondary mb-3">
	<div class="card-header">Tests</div>
	<div class="card-body text-secondary">
		<table rt:param="{$action_info.opt('test_list')}" rt:var="info" class="table table-sm table-striped style-table-borderless">
		<tr>
			<td>
				<a href="{$t.package_method_url('test_view')}?path={$info.name()}">
					{$info.opt('short_name')}
				</a>
			</td>
			<td>
				{$info.summary()}
			</td>
		</tr>
		</table>
	</div>
</div>
</rt:if>

</rt:block>
